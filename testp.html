<!doctype html>
<html>
<head>
   <meta charset="utf-8">
   <title>Babylon - Basic scene</title>
   <style>
      html, body {
         overflow: hidden;
         width: 100%;
         height: 100%;
         margin: 0;
         padding: 0;
      }
      #renderCanvas {
         width: 100%;
         height: 100%;
         touch-action: none;
      }
   </style>
   <script src="https://raw.githubusercontent.com/BabylonJS/Babylon.js/master/dist/preview%20release/babylon.noworker.js"></script>
</head>
<body>
   <canvas id="renderCanvas"></canvas>
   <script type="text/javascript">
           // Get the canvas element from our HTML below
      var canvas = document.querySelector("#renderCanvas");
      // Load the BABYLON 3D engine
      var engine = new BABYLON.Engine(canvas, true);
      // -------------------------------------------------------------
      // Here begins a function that we will 'call' just after it's built
		  
	  
var createScene = function () {


    var scene = new BABYLON.Scene(engine);
		scene.clearColor = new BABYLON.Color3(0.1, 0.1, 0.1)

	 var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 5, -15), scene);
   	 	camera.setTarget(BABYLON.Vector3.Zero());
    	camera.attachControl(canvas, true);
		camera.maxZ =500;
		camera.layerMask = 0x20000000;
	
   var meshCamera = new BABYLON.ArcRotateCamera("Camera", 0, 0, 10, new BABYLON.Vector3(0, 0, 0), scene);
   	     meshCamera.setPosition(new BABYLON.Vector3(0, 0, 500));
	     meshCamera.attachControl(canvas)
		 meshCamera.layerMask = 0x40000000;
		 
		scene.activeCameras.push(camera,meshCamera)
		
	var l = new BABYLON.HemisphericLight("", new BABYLON.Vector3(0.0,5.0, -25.0), scene)
        l.intensity = 1.1;
        l.diffuse = new BABYLON.Color3(0.6, 0.9, 1.0)
 
    var l1 = new BABYLON.HemisphericLight("", new BABYLON.Vector3(0.0,-1.0, -5.0), scene)
  	      l1.intensity = 0.5; l1.diffuse = new BABYLON.Color3(1.0, 0.8, 1.0)
	      l.excludeWithLayerMask = 0x20000000; 
	      l1.excludeWithLayerMask = 0x20000000;


function playvid(){
		
	 var light0 = new BABYLON.PointLight("Omni0", new BABYLON.Vector3(0, 10, -40), scene);
		 light0.intensity = 3.30;
		 light0.diffuse = new BABYLON.Color3(1, 1, 1);
	 	 light0.specular = new BABYLON.Color3(0, 0, 0);
		 light0.excludeWithLayerMask = 0x40000000;
		
	var sphere = BABYLON.Mesh.CreateSphere("sphere1", 32, 6, scene);
    sphere.position.y = 1;
	sphere.layerMask = 0x20000000;
			
	var material = new BABYLON.StandardMaterial("texture1", scene);
		  material.freeze();


var a= scene.onPointerObservable.add(function (d, s) {
	if (d.pickInfo.pickedMesh != null &&
		d.pickInfo.pickedMesh.name === whirlpool.name) {
			
		console.log("yeh")
		
			}
		}, 2)	
	}
	
	var sc = new BABYLON.ScreenSpaceCanvas2D(scene, {
		  id: "ScreenCanvas",children: [
		  new BABYLON.Rectangle2D({parent: sc, fill: "#99ccff0D",
		  roundRadius:32, width: 65, height: 65, marginAlignment: "h:stretch, v:bottom" }),
		  new BABYLON.Text2D("Enter", { parent: sc, fontSuperSample:true, 
		  fontName: "36pt Arial Black",
		  defaultFontColor: new BABYLON.Color4(0.9, 1.0, 1.0, 0.8),
          marginAlignment: "h:center, v:center" })
		  ] });
	
	  sc.children[0].margin.fromStrings('0%', '40%', '40%', '21%')
	  sc.children[1].margin.fromStrings('0.5%', '0%', '0%', '-25%')
	  
	var b = 0; 
	var textobser = scene.onAfterCameraRenderObservable.add(function ()  {
		sc.children[1].scale =  Math.sin(0.01*b);
		if (b > 120.0) { b = 60; sc.children[1].scale += Math.sin(0.1 * b); b = 0; }
		b++; 
	})
						
	sc.children[1].pointerEventObservable.add(function (p, e) {
		meshCamera.viewport = new BABYLON.Viewport(0.80, 0.00, 0.25, 0.1);
		whirlpool.layerMask =  0x20000000;
		meshCamera.renderingGroupId = 1;
		scene.onAfterCameraRenderObservable.clear();
		sc.dispose(); playvid();
		scene.clearColor = new BABYLON.Color3(0.01, 0.01, 0.05)
		}, 4);
		
	var points = [];
	for (var i = 0; i <360; i++) {
		var ae = Math.abs(BABYLON.Tools.ToRadians(i) * 150);
		var c = BABYLON.Tools.ToRadians(i + ae) * 50;
		var x = Math.sin(c) * i; var y = Math.cos(c) * i;
		points.push([new BABYLON.Vector3(x, y,12), new BABYLON.Vector3(x,y, 4)]);
	}
	var mat = new BABYLON.StandardMaterial("123", scene);
  	var whirlpool = BABYLON.MeshBuilder.CreateRibbon('grid', { pathArray: points }, scene);
		whirlpool.rotation.x = 15.9;
		whirlpool.layerMask =  0x40000000;
		whirlpool.material = mat
		whirlpool.material.fogEnabled =false

	var whirlpool2 = BABYLON.MeshBuilder.CreateRibbon('grid', { pathArray: points }, scene);
		whirlpool2.rotation.y = 0.09; whirlpool2.position.z -= 100;
		whirlpool2.flipFaces(true);   whirlpool2.convertToFlatShadedMesh();
		whirlpool2.layerMask = 0x40000000;
		whirlpool2.material = mat
		whirlpool2.material.fogEnabled =false

scene.registerAfterRender(function () {
	whirlpool.rotation.x -= 0.01; whirlpool2.rotation.z += 0.009
	 whirlpool2.rotation.x += 0.009; meshCamera.fov += 0.01;	
		 });//
	

    return scene;
}
      // -------------------------------------------------------------
      // Now, call the createScene function that you just finished creating
      var scene = createScene();
	  
      // Register a render loop to repeatedly render the scene
      engine.runRenderLoop(function () {
         scene.render();
		
      });
      // Watch for browser/canvas resize events
      window.addEventListener("resize", function () {
         engine.resize();
      });
   </script>
</body>
</html>